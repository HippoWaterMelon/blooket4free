<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Blooket4Free | My Blooks</title>

  <link rel="stylesheet"
    href="https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/css/121a1462914990a5.css"
    data-precedence="next">
  <link rel="stylesheet"
    href="https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/css/7d2a7f4491889bcd.css"
    data-precedence="next">
  <link rel="stylesheet"
    href="https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/css/43cb5a8b08a4fd81.css"
    data-precedence="next">
  <link rel="stylesheet"
    href="https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/css/a0406186fc01ce56.css"
    data-precedence="next">
  <link rel="stylesheet"
    href="https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/css/453191536c2b89e6.css"
    data-precedence="next">
  <link rel="stylesheet"
    href="https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/css/51e88ac748998e08.css"
    data-precedence="next">

  <style>
    /* preserve layout centering + hide token counter per your request */

    .TokenCounter_tokenContainer__wE6XL {
      display: none !important;
    }

    /* hide the template node itself */
    #blook-modal-template {
      display: none;
    }

    .BlooksWrapper_content__wfMjd,
    .BlooksWrapper_container___qLk4,
    .layout_main__mXTwS {
      margin-left: auto;
      margin-right: auto;
    }

    /* Sidebar wrapper (position + animation only) */
    #sidebar {
      position: fixed;
      top: 0;
      left: -300px;
      /* keep hidden */
      height: 100%;
      width: 300px;
      transition: left 0.3s ease;
      z-index: 1005;
    }

    /* Active state slides it in */
    #sidebar.active {
      left: 0;
    }

    /* Overlay (dark background behind sidebar) */
    #overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      z-index: 1004;
    }

    #overlay.active {
      display: block;
    }

    /* Hamburger button */
    .hamburger {
      position: fixed;
      top: 35px;
      right: 25px;
      /* move to top-right */
      font-size: 28px;
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      z-index: 1003;
    }

    .hamburger img {
      width: 30px;
      /* adjust size as needed */
      height: 30px;
      filter: drop-shadow(4px 4px var(--gray-shadow));
      transition: transform 0.2s;
    }

    .hamburger img:hover {
      transform: scale(0.95);
    }

    /* Close button (keeps original class styles, just positioning) */

    /* Always show the sidebar logo, ignore base media queries */
    /* Always show logo */
    .Sidebar_logoDesktop__NeFcd {
      display: block !important;
      margin: 0 auto 0 !important;
      /* default */
      width: 80% !important;
    }

    /* Mobile adjustments */
    @media (max-width: 849px) {
      .Sidebar_logoDesktop__NeFcd {
        margin-top: 20px !important;
      }
    }

    #sidebar.Sidebar_sidebar__J7H_G {
      justify-content: flex-start !important;
    }
  </style>
</head>

<!-- keep the exact body classes from your working file so Titan + font variables load -->

<body class="__variable_b724e5 __variable_f9d1f4">

  <!-- Sidebar -->
  <nav id="sidebar" class="Sidebar_sidebar__J7H_G">
    <img alt="Blooket" loading="lazy" width="168" decoding="async" data-nimg="1" class="Sidebar_logoDesktop__NeFcd"
      src="./assets/misc_images/logo.png">
    <ul class="Sidebar_list__ljw79">
      <li>
        <a class="Sidebar_link__pbkfx" href="/blooks.html">
          <span class="Sidebar_listIcon__rg5X6">
            <svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
              class="svg-inline--fa fa-suitcase fa-w-16">
              <path fill="currentColor"
                d="M128 480h256V80c0-26.5-21.5-48-48-48H176c-26.5 0-48 21.5-48 48v400zm64-384h128v32H192V96zm320 80v256c0 26.5-21.5 48-48 48h-48V128h48c26.5 0 48 21.5 48 48zM96 480H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48h48v352z">
              </path>
            </svg>
          </span>
          <span class="Sidebar_text__TwkTk">Blooks</span>
        </a>
      </li>

      <li>
        <a class="Sidebar_link__pbkfx" href="/">
          <span class="Sidebar_listIcon__rg5X6">
            <svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 616 512"
              class="svg-inline--fa fa-store fa-w-20">
              <path fill="currentColor"
                d="M602 118.6L537.1 15C531.3 5.7 521 0 510 0H106C95 0 84.7 5.7 78.9 15L14 118.6c-33.5 53.5-3.8 127.9 58.8 136.4 4.5.6 9.1.9 13.7.9 29.6 0 55.8-13 73.8-33.1 18 20.1 44.3 33.1 73.8 33.1 29.6 0 55.8-13 73.8-33.1 18 20.1 44.3 33.1 73.8 33.1 29.6 0 55.8-13 73.8-33.1 18.1 20.1 44.3 33.1 73.8 33.1 4.7 0 9.2-.3 13.7-.9 62.8-8.4 92.6-82.8 59-136.4zM529.5 288c-10 0-19.9-1.5-29.5-3.8V384H116v-99.8c-9.6 2.2-19.5 3.8-29.5 3.8-6 0-12.1-.4-18-1.2-5.6-.8-11.1-2.1-16.4-3.6V480c0 17.7 14.3 32 32 32h448c17.7 0 32-14.3 32-32V283.2c-5.4 1.6-10.8 2.9-16.4 3.6-6.1.8-12.1 1.2-18.2 1.2z">
              </path>
            </svg>
          </span>
          <span class="Sidebar_text__TwkTk">Market</span>
        </a>
      </li>
    </ul>
  </nav>

  <!-- Overlay -->
  <div id="overlay"></div>

  <!-- Hamburger -->
  <button id="hamburgerBtn" class="hamburger">
    <img src="./assets/misc_images/borgor.svg" alt="Menu">
  </button>

  <main class="layout_main__mXTwS">
    <div class="page_wrapper___woS4" data-sentry-component="Blooks">
      <!-- keep the original background wrapper unchanged -->
      <div class="_background_l90pt_1" style="background:linear-gradient(#0bc2cf,#349aef)">
        <div class="_checkers_l90pt_12" style="background-size:1000px"></div>
      </div>

      <h1 class="BlooksWrapper_header__OMK6W">Blooket4Free</h1>

      <div class="BlooksWrapper_content__wfMjd">
        <div class="BlooksWrapper_container___qLk4">
          <div class="BlooksHeader_row__D7cwg" data-sentry-component="BlooksHeader">
            <div class="BlooksHeader_buttons__0DDTc">
              <label class="BlooksHeader_button__I4Kms">
                <input id="toggle-free" type="checkbox" name="free">
                <span class="BlooksHeader_checkmark__Zztu9">
                  <!-- checkmark SVG (exact) -->
                  <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="check"
                    class="svg-inline--fa fa-check fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 512 512">
                    <path fill="currentColor"
                      d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z">
                    </path>
                  </svg>
                </span>
                Show Free Blooks
              </label>

              <label class="BlooksHeader_button__I4Kms">
                <input id="toggle-packs" type="checkbox" name="packs" checked>
                <span class="BlooksHeader_checkmark__Zztu9">
                  <!-- checkmark SVG (exact) -->
                  <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="check"
                    class="svg-inline--fa fa-check fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 512 512">
                    <path fill="currentColor"
                      d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z">
                    </path>
                  </svg>
                </span>
                Show Packs
              </label>
            </div>
          </div>

          <div class="BlooksPacks_container__nayTq" data-sentry-component="BlooksPacksContainer">
            <div id="packs-scroll" class="BlooksPacks_scrollbox__SPjLM"></div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- modal TEMPLATE (hidden) â€” structure matches your Horse popup exactly:
     left column = _blookContainer_inzvw_1 (blook), below it modal-bg img,
     right column = modal info (name, pack, rarity with small icon, description).
-->
  <div id="blook-modal-template">
    <div class="_modal_fhi6r_13 BlookModal_blookModal__kZ5LX">
      <button type="button" class="_closeIcon_fhi6r_70" aria-label="Close">
        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times"
          class="svg-inline--fa fa-times fa-w-11 " viewBox="0 0 352 512" xmlns="http://www.w3.org/2000/svg">
          <path fill="currentColor"
            d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z">
          </path>
        </svg>
        <span class="_srOnly_fhi6r_86">Close</span>
      </button>

      <div class="BlookModal_modalWrapper__TnRyt">
        <div class="BlookModal_modalBlook__y3uOR" data-sentry-component="BlookModalImage">
          <div class="_blookContainer_inzvw_1" data-tooltip-id="blook-tooltip"
            style="width:140px; z-index: var(--z-index-top);">
            <img class="_blook_inzvw_1" id="modal-img" src="" alt="" draggable="false">
          </div>
          <img id="modal-bg" class="BlookModal_blookBackground__azqLO" src="" alt="">
        </div>

        <form class="BlookModal_modalForm__PdjL_" action="javascript:;">
          <input type="hidden" name="blook" value="">
          <div class="BlookModal_modalInfo__Z2VdS" id="modal-info"></div>
        </form>
      </div>
    </div>
  </div>

  <script src="./assets/js/freepackdata.js"></script>
  <script src="./assets/js/packdata.js"></script>

  <script>
    /* tiny helpers */
    function esc(s) { if (s == null) return ''; return String(s).replace(/[&<>"']/g, c => ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[c])); }
    function normRarity(r) { return r ? String(r).trim().replace(/\s+/g, '') : 'Common'; }

    document.addEventListener('DOMContentLoaded', function () {
      const packsScroll = document.getElementById('packs-scroll');
      const chkFree = document.getElementById('toggle-free');
      const chkPacks = document.getElementById('toggle-packs');
      const modalTemplate = document.querySelector('#blook-modal-template > div');

      const freeArr = (typeof freePackData !== 'undefined' && Array.isArray(freePackData)) ? freePackData : [];
      const packArr = (typeof packData !== 'undefined' && Array.isArray(packData)) ? packData : [];
      const allPacks = [
        ...freeArr.map(p => (Object.assign({}, p, { _isFree: true }))),
        ...packArr.map(p => (Object.assign({}, p, { _isFree: false })))
      ];

      function createTile(name, img, rarity, pIdx, bIdx) {
        const rn = normRarity(rarity || 'Common');
        const root = document.createElement('div');
        root.className = 'BlookModal_blook__h0dTV';
        root.dataset.pack = String(pIdx);
        root.dataset.index = String(bIdx);

        // load counts from localStorage
        const stored = JSON.parse(localStorage.getItem("blooksCollection")) || {};
        const count = stored[name] || 0;

        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'BlookModal_blookButton__hSYIJ';

        const inner = document.createElement('div');
        inner.className = '_blookContainer_inzvw_1';
        inner.setAttribute('data-tooltip-id', 'blook-tooltip');

        const imgEl = document.createElement('img');
        imgEl.className = '_blook_inzvw_1';
        imgEl.draggable = false;
        imgEl.src = img || '';
        imgEl.alt = name || '';

        inner.appendChild(imgEl);
        btn.appendChild(inner);
        root.appendChild(btn);

        if (count > 0) {
          // unlocked
          const badge = document.createElement('div');
          badge.className = 'BlookModal_quantity__BiP_5';
          badge.style.backgroundColor = `var(--${rn})`;
          badge.textContent = count;
          root.appendChild(badge);
          root.dataset.locked = "false";
        } else {
          // locked
          root.dataset.locked = "true";
          imgEl.style.filter = "brightness(0)";

          const lock = document.createElement("img");
          lock.src = "./assets/misc_images/lock.svg";
          lock.style.position = "absolute";
          lock.style.top = "50%";
          lock.style.left = "50%";
          lock.style.transform = "translate(-50%, -50%)";
          lock.style.width = "40%";
          lock.style.zIndex = 2;

          root.style.position = "relative";
          root.appendChild(lock);
        }


        return root;
      }

      function render() {
        packsScroll.innerHTML = '';
        const showFree = chkFree ? chkFree.checked : true;
        const grouped = chkPacks ? chkPacks.checked : true;

        if (!grouped) {
          const grid = document.createElement('div');
          grid.className = 'BlooksPacks_blooks__ocBoL';
          allPacks.forEach((pack, pIdx) => {
            if (pack._isFree && !showFree) return;
            const names = Array.isArray(pack.blook) ? pack.blook : (Array.isArray(pack.blooks) ? pack.blooks : []);
            const svgs = Array.isArray(pack.svg) ? pack.svg : (Array.isArray(pack.svgs) ? pack.svgs : []);
            const rarities = Array.isArray(pack.rarity) ? pack.rarity : [];
            names.forEach((entry, i) => {
              let name = '', img = '', rarity = 'Common';
              if (typeof entry === 'string') { name = entry; img = svgs[i] || ''; rarity = rarities[i] || pack.rarity || 'Common'; }
              else { name = entry.name || entry.title || ''; img = entry.svg || entry.image || svgs[i] || ''; rarity = entry.rarity || rarities[i] || pack.rarity || 'Common'; }
              grid.appendChild(createTile(name, img, rarity, pIdx, i));
            });
          });
          packsScroll.appendChild(grid);
          return;
        }

        // grouped
        allPacks.forEach((pack, pIdx) => {
          if (pack._isFree && !showFree) return;
          const names = Array.isArray(pack.blook) ? pack.blook : (Array.isArray(pack.blooks) ? pack.blooks : []);
          if (!names.length) return;
          const svgs = Array.isArray(pack.svg) ? pack.svg : (Array.isArray(pack.svgs) ? pack.svgs : []);
          const rarities = Array.isArray(pack.rarity) ? pack.rarity : [];
          const packDiv = document.createElement('div');
          packDiv.className = 'BlooksPacks_pack___MJtt';
          // tileBackground may be a gradient or a url
          let bg = pack.tileBackground || pack.bg || '';
          if (bg && !String(bg).trim().startsWith('linear-gradient')) bg = `url('${esc(bg)}')`;
          packDiv.innerHTML = `
        <div class="BlooksPacks_textureHeader__1ecGZ">
          <div class="BlooksPacks_texture__7_8Gf" style="background-image:${bg}"></div>
          <h2 class="BlooksPacks_title__qiDcM">${esc(pack.name || pack.title || '')}</h2>
        </div>
        <div class="BlooksPacks_divider__mT_iM"></div>
        <div class="BlooksPacks_blooks__ocBoL"></div>`;
          const container = packDiv.querySelector('.BlooksPacks_blooks__ocBoL');
          names.forEach((entry, i) => {
            let name = '', img = '', rarity = 'Common';
            if (typeof entry === 'string') { name = entry; img = svgs[i] || ''; rarity = rarities[i] || pack.rarity || 'Common'; }
            else { name = entry.name || entry.title || ''; img = entry.svg || entry.image || svgs[i] || ''; rarity = entry.rarity || rarities[i] || pack.rarity || 'Common'; }
            container.appendChild(createTile(name, img, rarity, pIdx, i));
          });
          packsScroll.appendChild(packDiv);
        });
      }

      /* Open modal inline below the pack's blooks container and copy that container's background */
      function openModal(packIdx, bIdx, clickedTile) {
        closeModal();

        const pack = allPacks[Number(packIdx)];
        if (!pack) return;
        const names = Array.isArray(pack.blook) ? pack.blook : (Array.isArray(pack.blooks) ? pack.blooks : []);
        const svgs = Array.isArray(pack.svg) ? pack.svg : (Array.isArray(pack.svgs) ? pack.svgs : []);
        const rarities = Array.isArray(pack.rarity) ? pack.rarity : [];
        const descs = Array.isArray(pack.blookDesc) ? pack.blookDesc : (Array.isArray(pack.descs) ? pack.descs : []);
        const entry = names[Number(bIdx)];
        if (!entry) return;

        let name = '', imgSrc = '', rarity = 'Common', desc = '';
        if (typeof entry === 'string') { name = entry; imgSrc = svgs[bIdx] || ''; rarity = rarities[bIdx] || pack.rarity || 'Common'; desc = descs[bIdx] || ''; }
        else { name = entry.name || entry.title || ''; imgSrc = entry.svg || entry.image || svgs[bIdx] || ''; rarity = entry.rarity || rarities[bIdx] || pack.rarity || 'Common'; desc = entry.description || entry.desc || descs[bIdx] || ''; }

        // find the pack's blooks container (this is the purple box the tiles sit in)
        const packDiv = clickedTile.closest('.BlooksPacks_pack___MJtt');
        const blooksContainer = packDiv ? packDiv.querySelector('.BlooksPacks_blooks__ocBoL') : clickedTile.closest('.BlooksPacks_blooks__ocBoL');

        // clone modal template and populate
        const clone = modalTemplate.cloneNode(true);
        const modalImg = clone.querySelector('#modal-img');
        const modalBg = clone.querySelector('#modal-bg');
        const modalBlook = clone.querySelector('.BlookModal_modalBlook__y3uOR');
        const modalInfo = clone.querySelector('#modal-info');

        if (modalImg) { modalImg.src = imgSrc || ''; modalImg.alt = name || ''; }

        // if tileBackground is an image url, use it for modal-bg <img> (sits under the blook)
        // else if pack has gradient (linear-gradient...), apply that directly to the modalBlook container
        const bgVal = pack.blookBackground || pack.tileBackground || pack.bg || '';
        if (bgVal && String(bgVal).trim().startsWith('linear-gradient')) {
          if (modalBlook) modalBlook.style.backgroundImage = bgVal;
          if (modalBg) { modalBg.style.display = 'none'; modalBg.src = ''; }
        } else if (bgVal) {
          if (modalBg) { modalBg.style.display = ''; modalBg.src = bgVal; modalBg.alt = pack.name || ''; }
          if (modalBlook) modalBlook.style.backgroundImage = '';
        } else {
          if (modalBg) { modalBg.style.display = 'none'; modalBg.src = ''; }
          if (modalBlook) modalBlook.style.backgroundImage = '';
        }

        const rarityIcons = {
          Common: "https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/media/common.38546a9e.svg",
          Uncommon: "https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/media/uncommon.2b8463be.svg",
          Rare: "https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/media/rare.efca39f2.svg",
          Epic: "https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/media/epic.7f15d3ac.svg",
          Legendary: "https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/media/legendary.864a3830.svg",
          Chroma: "https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/media/chroma.2f1bc592.svg",
          Unique: "https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/media/unique.8a843b99.svg",
          Mystical: "https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/media/mystical.ad0d7147.svg"
        };

        const rarityIcon = rarityIcons[rarity] || "https://ac.blooket.com/dashboard/ee3082e9bdda941fdd8418c7b00c1d2ee1cd3a73/_next/static/media/common.38546a9e.svg";

        if (modalInfo) {
          modalInfo.innerHTML = `
        <h2>${esc(name)}</h2>
        <h3>${esc(pack.name || pack.title || '')}</h3>
        <div class="BlookModal_tags__My798">
          <span class="BlookModal_tag__iidYw">
            <img alt="${esc(rarity)}" draggable="false" loading="lazy" width="20" height="25" src="${rarityIcon}" style="color: transparent; margin: 0px 5px 0px -3px;">
            ${esc(rarity)}
          </span>
        </div>
        <div class="BlookModal_description__tq3g">${esc(desc || '')}</div>
      `;
        }

        // wire close button
        const closeBtn = clone.querySelector('._closeIcon_fhi6r_70');
        if (closeBtn) closeBtn.addEventListener('click', closeModal);

        // **copy computed background & width from the blooks container so the modal visually matches**
        if (clickedTile) {
          clickedTile.appendChild(clone);  // nest inside the tile
        } else if (blooksContainer) {
          blooksContainer.appendChild(clone);
        }

        // register outside-click close after a tick so the click that opened the modal doesn't immediately close it
        setTimeout(() => document.addEventListener('click', outsideClickClose), 0);
      }

      function closeModal() {
        const m = document.querySelector('._modal_fhi6r_13.BlookModal_blookModal__kZ5LX');
        if (m) m.remove();
        document.removeEventListener('click', outsideClickClose);
      }

      function outsideClickClose(e) {
        const m = document.querySelector('._modal_fhi6r_13.BlookModal_blookModal__kZ5LX');
        if (m && !m.contains(e.target) && !e.target.closest('.BlookModal_blook__h0dTV')) {
          closeModal();
        }
      }

      // tile click delegation
      packsScroll.addEventListener('click', function (ev) {
        const tile = ev.target.closest('.BlookModal_blook__h0dTV');
        if (!tile) return;

        if (tile.dataset.locked === "true") {
          ev.stopPropagation();
          ev.preventDefault();
          return;
        }

        openModal(tile.dataset.pack, tile.dataset.index, tile);
      });


      // toggles
      if (chkFree) chkFree.addEventListener('change', render);
      if (chkPacks) chkPacks.addEventListener('change', render);

      // Esc closes
      document.addEventListener('keydown', function (e) { if (e.key === 'Escape') closeModal(); });

      // initial paint
      render();

      chkFree.addEventListener('change', () => {
        render();
        packsScroll.scrollTop = 0;  // reset scroll to top
      });
    });    
  </script>

  <script>
    const hamburgerBtn = document.getElementById('hamburgerBtn');
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('overlay');

    function openSidebar() {
      sidebar.classList.add('active');
      overlay.classList.add('active');
    }

    function closeSidebarMenu() {
      sidebar.classList.remove('active');
      overlay.classList.remove('active');
    }

    hamburgerBtn.addEventListener('click', openSidebar);
    overlay.addEventListener('click', closeSidebarMenu);
  </script>

  <script src="./assets/js/particles.js"></script>

  <script>
    window.addEventListener('beforeunload', function (e) {
      e.preventDefault();
      e.returnValue = '';
    });
  </script>

  <script>
    window.addEventListener('beforeunload', function (e) {
      e.preventDefault();
      e.returnValue = '';
    });
  </script>
</body>

</html>